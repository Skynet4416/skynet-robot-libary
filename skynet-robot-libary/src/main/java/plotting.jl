using Plots;

rectangle(w, h, x, y) = Shape(x-(w/2) .+ [0,w,w,0], y-(h/2) .+ [0,0,h,h])

x_array = [0.34338715221616106, 0.6853240997697687, 1.0075817046952178, 1.3163601721934743, 1.6147264864729942, 1.9052796559258878, 2.1900477135430387, 2.4705232910519777, 2.7476424345125334, 3.0217587613812156, 3.2927507363215454, 3.5603484038861146, 3.8244328214446446, 4.085120337229668, 4.342741349922815, 4.597800869729275, 4.850936075771671, 5.102873486800261]


y_array = [0.9233420156393742, 1.651534858352609, 2.2619488512607795, 2.762481058120718, 3.1575472241991998, 3.4505751752533365, 3.6440245556792834, 3.7395503602450146, 3.738224051650695, 3.6409160815221986, 3.4488617856464012, 3.1641205067067895, 2.789630015501094, 2.329044394301272, 1.7865735483712137, 1.166843847235232, 0.47476764094877055, -0.2845785086607474]


x_array_runge_kutta = [0.37199278760358256, 0.7458676325492328, 1.0881578791506838, 1.3982381943796516, 1.6836007723796877, 1.9513911301825713, 2.207005324257029, 2.45432109338125, 2.6960292540857362, 2.933815388121888, 3.1684745522293127, 3.400191000587208, 3.6289563709479227, 3.854870765589115, 4.078279137051767, 4.299804602177344, 4.520325051633559, 4.740917939602196]


y_array_runge_kutta  = [1.0207144581633074, 1.876089545337992, 2.5878606525186427, 3.1535437791288286, 3.583708265755196, 3.8880550225670474, 4.0737265658500075, 4.145653708687949, 4.107055488673341, 3.9599444731198563, 3.7058111000769944, 3.346458818217488, 2.884575078489418, 2.3239136707647385, 1.6692607423549641, 0.9263030943272984, 0.1014458423525082, -0.7983974193393318]
plot(x_array,y_array,label="magnus recursion",linecolor=:blue)
plot!(x_array_runge_kutta,y_array_runge_kutta,label="runge kutta",linecolor=:red)
plot!(rectangle(1.22,0.05,4.0,2.7178),opacity = 0.5)

# polyfit(x_array_lift_recursion,y_array_lift_recursion)
# plot!(x_array_drag_recursion,y_array_drag_recursion,label="drag recursion",linecolor=:red)
# plot!(x_array_drag_no_recursion,y_array_drag_no_recursion,label="drag no recursion",linecolor=:orange)
# plot!(x_array_lift_no_recursion,y_array_lift_no_recursion,label="magnus no recursion",linecolor=:black)
# plot!(x_array_changing_lift_recursion,y_array_changing_lift_recursion,label="magnus recursion",linecolor=:pink)
# plot!(x_array_nasa_lift_recursion,y_array_nasa_lift_recursion,label="magnus recursion",linecolor=:pink)


savefig("test"); print("Done\n")
